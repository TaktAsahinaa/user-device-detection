<!DOCTYPE html>
<html>
    <head>
        <meta http-equiv="Delegate-CH" content="sec-ch-ua-full-version-list https://cloud.51degrees.com; sec-ch-ua-model https://cloud.51degrees.com; sec-ch-ua-platform https://cloud.51degrees.com; sec-ch-ua-platform-version https://cloud.51degrees.com"/>
    </head>
    <body>
        <h1>51Degrees Cloud Example</h1>
        <button type="button" onclick="buttonClicked()">Use my location</button>
        <div id="htmlExampleOutput"></div>
    </body>
    <script async src="https://cloud.51degrees.com/api/v4/AQS2AzU4Hto4VSVU3Ug.js"></script>
    <script type="text/javascript">
      const detectNow = () => {
            fod.complete(function (data) {
                console.log(data);
                
                // Fetch the properties from the JSON response and write to the page.
                addText("IsMobile: " + data.device["ismobile"]);
                addText("JavascriptGetHighEntropyValues: " + data.device["javascriptgethighentropyvalues"]);
                addText("SetHeaderBrowserAccept-CH: " + data.device["setheaderbrowseraccept-ch"]);
                addText("SetHeaderHardwareAccept-CH: " + data.device["setheaderhardwareaccept-ch"]);
                addText("HardwareVendor: " + data.device["hardwarevendor"]);
                addText("HardwareModel: " + data.device["hardwaremodel"]);
                addText("HardwareName: " + data.device["hardwarename"]);
                addText("DeviceType: " + data.device["devicetype"]);
                addText("HardwareRank: " + data.device["hardwarerank"]);
                addText("ScreenPixelsWidthJavaScript: " + data.device["screenpixelswidthjavascript"]);
                addText("HardwareFamily: " + data.device["hardwarefamily"]);
                addText("OEM: " + data.device["oem"]);
                addText("SupportedChargerTypes: " + data.device["supportedchargertypes"]);
                addText("BatteryCapacity: " + data.device["batterycapacity"]);
                addText("SupportedSensorTypes: " + data.device["supportedsensortypes"]);
                
                // Check for High Entropy Values using User-Agent Client Hints
                if (navigator.userAgentData) {
                    navigator.userAgentData.getHighEntropyValues(["model", "platform", "platformVersion", "fullVersionList"])
                    .then(entropyData => {
                        console.log(entropyData);
                        document.cookie = `51D_GetHighEntropyValues=${btoa(JSON.stringify(entropyData))}`;
                        // Display high entropy values
                        addText("Model: " + entropyData.model);
                        addText("Platform: " + entropyData.platform);
                        addText("Platform Version: " + entropyData.platformVersion);
                        addText("Full Version List: " + JSON.stringify(entropyData.fullVersionList));
                    })
                    .catch(err => {
                        console.error("Error retrieving high entropy values:", err);
                    });
                } else {
                    console.log("High Entropy Values not supported by this browser.");
                    addText("High Entropy Values are not supported by this browser.");
                }
            });
        }

        function addText(text) {
            document.getElementById("htmlExampleOutput").innerHTML += text + "<br>";
        }

        function buttonClicked() {
            detectNow()
            alert("Button clicked! Location functionality to be implemented.");
        }
    </script>
    <script>javascript:(function () { var script = document.createElement('script'); script.src="//cdn.jsdelivr.net/npm/eruda"; document.body.appendChild(script); script.onload = function () { eruda.init() } })();</script>
</html>
